@page "/components/themeprovider"

<PageTitle>ThemeProvider - Vibe.UI</PageTitle>

<ComponentPage ComponentName="ThemeProvider"
               Category="Theme"
               Description="A context provider component that manages theme state and provides theme configuration to all child components."
               RelatedComponents="@relatedComponents">

    <PreviewContent>
        <div class="preview-demo" style="display: flex; flex-direction: column; gap: 1.5rem;">
            <Alert Variant="Alert.AlertVariant.Info">
                <strong>ThemeRoot Component</strong>
                <br />
                The actual component is named <code>ThemeRoot</code> in the source code. It wraps your entire application
                to provide theme context to all child components.
            </Alert>

            <div style="padding: 1.5rem; border: 1px dashed var(--border-color); border-radius: 8px; background: var(--surface-color);">
                <h4>Theme Context Information</h4>
                <p><strong>Current Theme:</strong> @(ThemeManager?.CurrentTheme?.Name ?? "Loading...")</p>
                <p><strong>Theme ID:</strong> @(ThemeManager?.CurrentTheme?.Id ?? "N/A")</p>
                <p><strong>Available Themes:</strong> @(ThemeManager?.AvailableThemes?.Count ?? 0)</p>

                <div style="margin-top: 1rem;">
                    <ThemeToggle />
                    <span style="margin-left: 0.5rem;">Toggle to see theme changes in action</span>
                </div>
            </div>

            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                <Card>
                    <h5>Card 1</h5>
                    <p>Automatically themed</p>
                </Card>
                <Card>
                    <h5>Card 2</h5>
                    <p>Responds to theme</p>
                </Card>
                <Card>
                    <h5>Card 3</h5>
                    <p>No extra code needed</p>
                </Card>
            </div>

            <Alert Variant="Alert.AlertVariant.Success">
                All components within the ThemeRoot automatically receive theme context and styling.
            </Alert>
        </div>
    </PreviewContent>

    <Examples>
        <div class="example-item">
            <h3>Basic Setup</h3>
            <CodeBlock Code="@BasicCode" Language="razor" />
        </div>

        <div class="example-item">
            <h3>Custom Theme Configuration</h3>
            <CodeBlock Code="@CustomConfigCode" Language="razor" />
        </div>

        <div class="example-item">
            <h3>Multiple Themes</h3>
            <CodeBlock Code="@MultipleThemesCode" Language="razor" />
        </div>

        <div class="example-item">
            <h3>Accessing Theme Context</h3>
            <CodeBlock Code="@AccessContextCode" Language="razor" />
        </div>

        <div class="example-item">
            <h3>Full Application Setup</h3>
            <CodeBlock Code="@FullSetupCode" Language="razor" />
        </div>
    </Examples>

    <Props>
        <table class="api-table">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Type</th>
                    <th>Default</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>DefaultTheme</code></td>
                    <td>ThemeMode</td>
                    <td>Light</td>
                    <td>Initial theme mode</td>
                </tr>
                <tr>
                    <td><code>ThemeConfiguration</code></td>
                    <td>ThemeConfig</td>
                    <td>-</td>
                    <td>Custom theme configuration</td>
                </tr>
                <tr>
                    <td><code>StorageKey</code></td>
                    <td>string</td>
                    <td>"theme-preference"</td>
                    <td>LocalStorage key for persisting theme</td>
                </tr>
                <tr>
                    <td><code>RespectSystemPreference</code></td>
                    <td>bool</td>
                    <td>true</td>
                    <td>Use system theme preference by default</td>
                </tr>
                <tr>
                    <td><code>TransitionDuration</code></td>
                    <td>int</td>
                    <td>200</td>
                    <td>Theme transition duration in milliseconds</td>
                </tr>
                <tr>
                    <td><code>ChildContent</code></td>
                    <td>RenderFragment</td>
                    <td>-</td>
                    <td>Child components wrapped by provider</td>
                </tr>
            </tbody>
        </table>
    </Props>

    <Events>
        <table class="api-table">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Type</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>OnThemeChanged</code></td>
                    <td>EventCallback&lt;ThemeMode&gt;</td>
                    <td>Callback when theme changes</td>
                </tr>
            </tbody>
        </table>
    </Events>

    <AccessibilityNotes>
        <ul>
            <li>Applies theme classes to document root</li>
            <li>Manages CSS custom properties for theming</li>
            <li>Respects user's system color scheme preference</li>
            <li>Smooth transitions between themes</li>
            <li>No ARIA attributes needed (non-visual component)</li>
            <li>Persists user theme preference across sessions</li>
        </ul>
    </AccessibilityNotes>
</ComponentPage>

@using Vibe.UI.Themes.Services
@inject ThemeManager ThemeManager

@code {
    private List<string> relatedComponents = new() { "ThemeToggle", "CascadingValue" };

    private string BasicCode => @"// App.razor or MainLayout.razor
<ThemeProvider>
    <Router AppAssembly=""@typeof(App).Assembly"">
        <Found Context=""routeData"">
            <RouteView RouteData=""@routeData"" DefaultLayout=""@typeof(MainLayout)"" />
        </Found>
        <NotFound>
            <h1>Page not found</h1>
        </NotFound>
    </Router>
</ThemeProvider>";

    private string CustomConfigCode => @"@code {
    private ThemeConfig customTheme = new ThemeConfig
    {
        Light = new ThemeColors
        {
            Primary = ""#0066cc"",
            Secondary = ""#6c757d"",
            Background = ""#ffffff"",
            Surface = ""#f8f9fa"",
            Text = ""#212529"",
            Border = ""#dee2e6""
        },
        Dark = new ThemeColors
        {
            Primary = ""#4da3ff"",
            Secondary = ""#adb5bd"",
            Background = ""#1a1a1a"",
            Surface = ""#2d2d2d"",
            Text = ""#f8f9fa"",
            Border = ""#495057""
        }
    };
}

<ThemeProvider ThemeConfiguration=""@customTheme""
               DefaultTheme=""ThemeMode.Dark"">
    @* Your app content *@
</ThemeProvider>";

    private string MultipleThemesCode => @"@code {
    private ThemeConfig multiThemeConfig = new ThemeConfig
    {
        Themes = new Dictionary<string, ThemeColors>
        {
            [""light""] = new ThemeColors
            {
                Primary = ""#0066cc"",
                Background = ""#ffffff"",
                Text = ""#000000""
            },
            [""dark""] = new ThemeColors
            {
                Primary = ""#4da3ff"",
                Background = ""#1a1a1a"",
                Text = ""#ffffff""
            },
            [""ocean""] = new ThemeColors
            {
                Primary = ""#0077be"",
                Background = ""#e6f3f9"",
                Text = ""#003d5c""
            },
            [""forest""] = new ThemeColors
            {
                Primary = ""#228b22"",
                Background = ""#f0f8f0"",
                Text = ""#1a4d1a""
            }
        }
    };
}

<ThemeProvider ThemeConfiguration=""@multiThemeConfig""
               DefaultTheme=""ThemeMode.Custom""
               CustomThemeName=""ocean"">
    @* Your app with multiple theme options *@
</ThemeProvider>";

    private string AccessContextCode => @"@inject IThemeService ThemeService

<CascadingValue Value=""@ThemeService"">
    <MyComponent />
</CascadingValue>

@* In MyComponent.razor *@
@code {
    [CascadingParameter]
    public IThemeService ThemeService { get; set; }

    private async Task ToggleTheme()
    {
        var currentTheme = await ThemeService.GetCurrentThemeAsync();
        var newTheme = currentTheme == ThemeMode.Light
            ? ThemeMode.Dark
            : ThemeMode.Light;

        await ThemeService.SetThemeAsync(newTheme);
    }

    private async Task<string> GetThemeColor(string colorName)
    {
        return await ThemeService.GetColorAsync(colorName);
    }
}

@* Alternative: Using context directly *@
<ThemeProvider>
    <ThemeContext.Consumer>
        @{
            var theme = context.CurrentTheme;
            var colors = context.Colors;

            <div style=""background: @colors.Background; color: @colors.Text"">
                <h1>Current Theme: @theme</h1>
                <Button OnClick=""@context.ToggleTheme"">
                    Switch to @(theme == ThemeMode.Light ? ""Dark"" : ""Light"")
                </Button>
            </div>
        }
    </ThemeContext.Consumer>
</ThemeProvider>";

    private string FullSetupCode => @"// Program.cs
builder.Services.AddVibeUI();
builder.Services.AddScoped<IThemeService, ThemeService>();

// App.razor
<ThemeProvider DefaultTheme=""ThemeMode.System""
               RespectSystemPreference=""true""
               StorageKey=""my-app-theme""
               OnThemeChanged=""@HandleThemeChanged"">
    <Router AppAssembly=""@typeof(App).Assembly"">
        <Found Context=""routeData"">
            <RouteView RouteData=""@routeData"" DefaultLayout=""@typeof(MainLayout)"" />
        </Found>
    </Router>
</ThemeProvider>

@code {
    private void HandleThemeChanged(ThemeMode newTheme)
    {
        // Log analytics, update user preferences, etc.
        Console.WriteLine($""Theme changed to: {newTheme}"");
    }
}

// MainLayout.razor
@inherits LayoutComponentBase

<div class=""app-layout"">
    <header>
        <nav class=""navbar"">
            <div class=""navbar-brand"">My App</div>
            <div class=""navbar-actions"">
                <ThemeToggle />
            </div>
        </nav>
    </header>

    <main class=""main-content"">
        @Body
    </main>

    <footer>
        <p>&copy; 2024 My App</p>
    </footer>
</div>

// wwwroot/css/app.css
:root {
    --color-primary: var(--theme-primary);
    --color-background: var(--theme-background);
    --color-text: var(--theme-text);
    --color-border: var(--theme-border);
}

[data-theme=""light""] {
    --theme-primary: #0066cc;
    --theme-background: #ffffff;
    --theme-text: #000000;
    --theme-border: #e0e0e0;
}

[data-theme=""dark""] {
    --theme-primary: #4da3ff;
    --theme-background: #1a1a1a;
    --theme-text: #ffffff;
    --theme-border: #333333;
}

body {
    background-color: var(--color-background);
    color: var(--color-text);
    transition: background-color 0.2s, color 0.2s;
}

// Usage in components
<div class=""card"">
    <h2>Dynamic Themed Card</h2>
    <p>This card automatically adapts to the current theme.</p>
    <Button Variant=""ButtonVariant.Primary"">Primary Action</Button>
</div>

<style>
    .card {
        background: var(--color-background);
        border: 1px solid var(--color-border);
        color: var(--color-text);
    }
</style>";
}
