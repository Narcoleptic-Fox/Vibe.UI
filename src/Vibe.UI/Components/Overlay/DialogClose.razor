@namespace Vibe.UI.Components
@inherits Vibe.UI.Base.VibeComponent

<button type="button" class="@CombinedClass" @onclick="OnCloseClick" aria-label="Close" @attributes="AdditionalAttributes">
    @if (ChildContent != null)
    {
        @ChildContent
    }
    else
    {
        <span class="vibe-dialog-close-icon" aria-hidden="true">&times;</span>
    }
</button>

@code {
    /// <summary>
    /// Gets or sets the content for the close button.
    /// If not provided, a default close icon (Ã—) will be displayed.
    /// </summary>
    [Parameter]
    public RenderFragment? ChildContent { get; set; }

    /// <summary>
    /// Gets or sets an optional callback that is invoked when the close button is clicked.
    /// </summary>
    [Parameter]
    public EventCallback OnClick { get; set; }

    /// <summary>
    /// Gets the cascading DialogContext from a parent component.
    /// </summary>
    [CascadingParameter]
    private DialogContext? Context { get; set; }

    /// <inheritdoc/>
    protected override string ComponentClass => "vibe-dialog-close";

    /// <summary>
    /// Handles the close button click event, closing the dialog through the cascading context.
    /// </summary>
    private async Task OnCloseClick()
    {
        if (Context != null)
        {
            await Context.Close();
        }

        if (OnClick.HasDelegate)
        {
            await OnClick.InvokeAsync();
        }
    }
}
